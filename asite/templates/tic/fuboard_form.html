<head>
	<meta http-equiv="content-type" content="text/html; charset=UTF-8">
        <meta http-equiv="X-UA-Compatible" content="Edge">
        <link rel="stylesheet" href="http://slo.me/t3/css/t5.css">
</head>
	{{form.id}}
	<form id="wrap" action="" method="post">
	{% csrf_token %}
	{% for field in form %}
	
		<div class="{{field.value}}"  id="{{field.name }}"  >
		
		<input  "type=hidden"  name="{{field.name}}" class="nosee" value="{{field.value}}"/>
		
		</div>
	{% endfor %}
	</form>
	 
	
<script>

	//adds and removes clicks for the tic tac toe board
	var tic={

		xplayer:	'x',

		oplayer:	'o',
		 		
		klass:		'n',

		squares:	[],
	
	
		mksquares: function(){
			var ticnodes=document.querySelectorAll('#wrap div')
			tic.squares=Array.prototype.slice.call(ticnodes)
	
		
		addclicks: function(){
			tic.squares.map(tic.addclick)
		},
			
		addclick: function(el){ 
			if (el.className===tic.klass){
				el.onclick=function(){ 
					tic.rmclicks()
					tic.setsquare(this.id,tic.oplayer)
					document.forms[0].submit()
					return false
				}
			}	
		},		
	
		rmclick: function(el){
				el.onclick=null
		},
		
		rmclicks: function(el){
			tic.squares.map(tic.rmclick)	
		},	
	
		setsquare: function(square,xo){
			var el=document.getElementById(square)	
			el.className=xo
			var elcid=document.forms[0][el.id]
			elcid.value=xo
			el.onclick=null
						
		}, 

		init: function(){
			tic.mksquares()		
			tic.addclicks()
			scaler.all()
		}	
	}// end tic 

	/** Scales the tic tac toe board to match screen size
		and makes the squares, "square"
	**/	
	var scaler={

		up:1,

		down: 0.27,	
	
		mk: function(){
			var sw=document.querySelector('body').offsetWidth
			sh=window.innerHeight
			scaler.up=sw
			if (sh < sw) {
				scaler.up=sh
			}
		},

		wrap: function(){
			var wr=document.querySelector('#wrap')
			wr.style.width=scaler.up +'px'
			wr.style.height=wr.style.width

		},

		tic: function(tic){
	        	tscale=(scaler.scale*scaler.down)+"px"
	        	tic.style.height=tscale
			tic.style.width=tscale
		},
		
		all: function(){
			scaler.mk()
			scaler.wrap()
			var rtic=tic.squares.reverse()
			rtic.map(scaler.tic)
		}	
	}

		//Fades in the tic tac toe board
	var cascade={
	
		step: 200,
		chunk:0.01,

		swing: function( p ) {
			return 0.57 - Math.cos( p*Math.PI ) / 1.7;
		},
	
		cycle: function(el){
			var o=0.0
			fadein()
			function fadein(){
				o=parseFloat(o)+cascade.chunk
				el.style.opacity=o	
				if (o < 1 ){
					setTimeout(fadein,cascade.swing(1-o))
				}else {
					el.style.opacity=1
					return 0
				}	
			}
		},	

		
		all: function(nodes){
			
			nodes.map(function(el){el.style.opacity=0})	
			var nl=nodes.length
			var step=cascade.step
			while (nl--){
				var el=nodes[nl]	
				setTimeout(cascade.cycle,step,el)
				step+=200	
			}	
		}	

	}
	
tic.init()
</script>

	<script>
		{% if pick %}
			tic.setsquare("{{pick}}",tic.xplayer)
			document.forms[0]["{{pick}}"].value=tic.xplayer	
			tic.addclicks()
		 {% endif %}
		 
		 {% if wingroup|length == 3 %}
			 {% for wg in wingroup %}
				tic.setsquare("{{wg}}"," win ")
			 {% endfor %}
			tic.rmclicks()
		{% endif %}
		
		{% if freshboard %}
			tic.init()
			cascade.all(tic.squares)
		{% endif %} 						
     </script>    
	